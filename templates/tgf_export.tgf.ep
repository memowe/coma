%# iterate over connections to generate IDs
% my ($last_id, %id) = (0);
% my @sorted_conn    = sort {"$a->type" cmp "$b->type"} $map->connections->all;
% for my $conn (@sorted_conn) {
%   $id{$_} //= ++$last_id for $conn->from_name, $conn->to_name;
% }
%# entities
% for my $entity (sort {$id{$a} <=> $id{$b}} keys %id) {
%=  $id{$entity} . ' ' . $entity;
% }
#
%# connections
% for my $conn (@sorted_conn) {
%== join ' ' => @id{$conn->from_name, $conn->to_name} => $conn->type
% }
